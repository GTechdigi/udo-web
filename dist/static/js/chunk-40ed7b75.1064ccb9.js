(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-40ed7b75"],{"1d01":function(e,t,r){"use strict";r("8463")},"24d2":function(e,t,r){"use strict";r.d(t,"g",(function(){return u})),r.d(t,"e",(function(){return l})),r.d(t,"a",(function(){return n})),r.d(t,"c",(function(){return a})),r.d(t,"h",(function(){return s})),r.d(t,"f",(function(){return d})),r.d(t,"b",(function(){return i})),r.d(t,"d",(function(){return c}));var o=r("b775");function u(e){return Object(o["a"])({url:"/project/list",method:"get",params:e})}function l(e){return Object(o["a"])({url:"/project/"+e,method:"get"})}function n(e){return Object(o["a"])({url:"/project/add",method:"post",data:e})}function a(e){return Object(o["a"])({url:"/project/delProject",method:"get",params:e})}function s(e,t){return Object(o["a"])({url:"/project/update/"+e,method:"post",data:t})}function d(e){return Object(o["a"])({url:"/projectUser/list",method:"get",params:e})}function i(e){return Object(o["a"])({url:"/projectUser/add",method:"post",data:e})}function c(e){return Object(o["a"])({url:"/projectUser/delete",method:"get",params:e})}},"34c6":function(e,t,r){"use strict";r.d(t,"c",(function(){return u})),r.d(t,"a",(function(){return l})),r.d(t,"f",(function(){return n})),r.d(t,"e",(function(){return a})),r.d(t,"b",(function(){return s})),r.d(t,"d",(function(){return d}));var o=r("b775");function u(e){return Object(o["a"])({url:"/rule/list",method:"get",params:e})}function l(e){return Object(o["a"])({url:"/rule/add",method:"post",data:e})}function n(e,t){return Object(o["a"])({url:"/rule/update/"+e,method:"post",data:t})}function a(e){return Object(o["a"])({url:"/runRule/runRule/"+e,method:"get"})}function s(e){return Object(o["a"])({url:"/rule/deleteRule/"+e,method:"get"})}function d(e){return Object(o["a"])({url:"/rule/info",method:"get",params:e})}},"6e4a":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"create"},[r("div",{staticClass:"create-body"},[r("el-form",{ref:"job_form",staticClass:"demo-ruleForm",attrs:{"label-width":"100px",rules:e.form_rules,model:e.request_body}},[r("el-form-item",{attrs:{label:"任务名称",prop:"job_name"}},[r("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入任务名称"},model:{value:e.request_body.job_name,callback:function(t){e.$set(e.request_body,"job_name",t)},expression:"request_body.job_name"}})],1),r("el-form-item",{attrs:{label:"项目类别",prop:"project_name"}},[r("el-select",{attrs:{placeholder:"请选择项目类别"},on:{change:e.clearRule},model:{value:e.request_body.project_code,callback:function(t){e.$set(e.request_body,"project_code",t)},expression:"request_body.project_code"}},e._l(e.projects,(function(e){return r("el-option",{key:e.project_code,attrs:{label:e.project_name,value:e.project_code}})})),1)],1),r("el-form-item",{attrs:{label:"调度规则",prop:"rule_code"}},[r("el-select",{attrs:{clearable:"",filterable:"",remote:"",multiple:"","remote-method":e.queryRuleList,placeholder:"请选择调度规则"},model:{value:e.request_body.rule_code,callback:function(t){e.$set(e.request_body,"rule_code",t)},expression:"request_body.rule_code"}},e._l(e.rule_list,(function(e){var t=e.rule_code,o=e.rule_name;return r("el-option",{key:t,attrs:{label:o,value:t}})})),1)],1),r("div",{staticClass:"cron"},[r("el-form-item",{attrs:{label:"调度配置"}},[r("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择调度方式"},model:{value:e.request_body.trigger,callback:function(t){e.$set(e.request_body,"trigger",t)},expression:"request_body.trigger"}},e._l(e.triggers,(function(e){return r("el-option",{key:e.name,attrs:{label:e.name,value:e.trigger}})})),1),"date"==e.request_body.trigger?r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择日期时间"},model:{value:e.request_body.run_date,callback:function(t){e.$set(e.request_body,"run_date",t)},expression:"request_body.run_date"}}):e._e(),"interval"==e.request_body.trigger?r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择开始时间"},model:{value:e.request_body.start_date,callback:function(t){e.$set(e.request_body,"start_date",t)},expression:"request_body.start_date"}}):e._e(),"interval"==e.request_body.trigger?r("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择间隔类型"},model:{value:e.interval_type,callback:function(t){e.interval_type=t},expression:"interval_type"}},e._l(e.interval,(function(e){return r("el-option",{key:e.name,attrs:{label:e.name,value:e.type}})})),1):e._e(),"interval"==e.request_body.trigger?r("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入间隔时间"},model:{value:e.interval_value,callback:function(t){e.interval_value=t},expression:"interval_value"}}):e._e()],1),"cron"==e.request_body.trigger?r("el-form-item",{attrs:{label:"年"}},[r("el-input",{staticStyle:{width:"240px"},attrs:{placeholder:"*"},model:{value:e.request_body.year,callback:function(t){e.$set(e.request_body,"year",t)},expression:"request_body.year"}})],1):e._e(),"cron"==e.request_body.trigger?r("el-form-item",{attrs:{label:"月"}},[r("el-input",{staticStyle:{width:"240px"},attrs:{placeholder:"*"},model:{value:e.request_body.month,callback:function(t){e.$set(e.request_body,"month",t)},expression:"request_body.month"}})],1):e._e(),"cron"==e.request_body.trigger?r("el-form-item",{attrs:{label:"日"}},[r("el-input",{staticStyle:{width:"240px"},attrs:{placeholder:"*"},model:{value:e.request_body.day,callback:function(t){e.$set(e.request_body,"day",t)},expression:"request_body.day"}})],1):e._e(),"cron"==e.request_body.trigger?r("el-form-item",{attrs:{label:"周"}},[r("el-input",{staticStyle:{width:"240px"},attrs:{placeholder:"*"},model:{value:e.request_body.week,callback:function(t){e.$set(e.request_body,"week",t)},expression:"request_body.week"}})],1):e._e(),"cron"==e.request_body.trigger?r("el-form-item",{attrs:{label:"周几"}},[r("el-input",{staticStyle:{width:"240px"},attrs:{placeholder:"*"},model:{value:e.request_body.day_of_week,callback:function(t){e.$set(e.request_body,"day_of_week",t)},expression:"request_body.day_of_week"}})],1):e._e(),"cron"==e.request_body.trigger?r("el-form-item",{attrs:{label:"小时"}},[r("el-input",{staticStyle:{width:"240px"},attrs:{placeholder:"*"},model:{value:e.request_body.hour,callback:function(t){e.$set(e.request_body,"hour",t)},expression:"request_body.hour"}})],1):e._e(),"cron"==e.request_body.trigger?r("el-form-item",{attrs:{label:"分"}},[r("el-input",{staticStyle:{width:"240px"},attrs:{placeholder:"0"},model:{value:e.request_body.minute,callback:function(t){e.$set(e.request_body,"minute",t)},expression:"request_body.minute"}})],1):e._e(),"cron"==e.request_body.trigger?r("el-form-item",{attrs:{label:"秒"}},[r("el-input",{staticStyle:{width:"240px"},attrs:{placeholder:"0"},model:{value:e.request_body.second,callback:function(t){e.$set(e.request_body,"second",t)},expression:"request_body.second"}})],1):e._e()],1),r("el-form-item",[e.createStatus?r("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("立即创建")]):e._e(),e.createStatus?e._e():r("el-button",{attrs:{type:"primary"},on:{click:e.update}},[e._v("立即保存")]),r("el-button",{on:{click:e.backHistory}},[e._v("返回")])],1)],1)],1)])},u=[],l=(r("14d9"),r("34c6")),n=r("76fe"),a=r("24d2"),s={data:function(){return{createStatus:!0,rule_list:null,projects:[],form_rules:{job_name:[{required:!0,message:"名称不能为空",trigger:"blur"}],project_code:[{required:!0,message:"项目类别不能为空",trigger:"change"}],rule_code:[{required:!0,message:"调度任务不能为空",trigger:"change"}]},triggers:[{name:"指定时间执行",trigger:"date"},{name:"间隔执行",trigger:"interval"},{name:"cron调度器",trigger:"cron"}],interval:[{name:"间隔几天",type:"days"},{name:"间隔几小时",type:"hours"},{name:"间隔几分钟",type:"minutes"},{name:"间隔多少秒",type:"seconds"}],project_code:null,job_id:null,interval_type:null,interval_value:null,source_type:null,test:{id:1,name:"123"},tableStatus:!0,fieldStatus:!0,key_value:null,ruleForm:{},disables:{table:!0,field:!0},value1:null,request_body:{project_code:null,project_name:null,rule_code:[],job_name:null,trigger:null,run_date:null,start_date:null,end_date:null,year:null,month:null,day:null,day_of_week:null,hour:null,minute:0,second:0,status:1}}},created:function(){var e=this,t=this.$route.query;t.job_id?(this.job_id=t.job_id,this.createStatus=!1,this.jobInfo()):this.request_body.rule_type=t.rule_type,Object(a["g"])({page_size:30}).then((function(t){e.projects=t.data.list}))},methods:{jobInfo:function(){var e=this;Object(n["d"])(this.job_id).then((function(t){e.request_body=t.data,e.queryRuleList(),"interval"===e.request_body.trigger&&(e.request_body.day?(e.interval_type="days",e.interval_value=e.request_body.day):e.request_body.hour?(e.interval_type="hours",e.interval_value=e.request_body.hour):e.request_body.minute?(e.interval_type="minutes",e.interval_value=e.request_body.minute):e.request_body.second&&(e.interval_type="seconds",e.interval_value=e.request_body.second))}))},queryRuleList:function(e){var t=this;Object(l["c"])({project_code:this.request_body.project_code,page_size:100,rule_name:e}).then((function(e){t.rule_list=e.data.list}))},add:function(){var e=this;this.$refs["job_form"].validate((function(t){t&&("interval"===e.request_body.trigger&&("days"===e.interval_type?e.request_body.day=e.interval_value:"hours"===e.interval_type?e.request_body.hour=e.interval_value:"minutes"===e.interval_type?e.request_body.minute=e.interval_value:"seconds"===e.interval_type&&(e.request_body.second=e.interval_value)),"cron"===e.request_body.trigger&&(e.request_body.start_date=null),Object(n["a"])(e.request_body).then((function(t){var r=t.success;console.log(r),!0===r?(e.$router.push("/job/list"),e.$notify({title:"成功",message:"创建规则成功",type:"success"})):e.$alert(e.message["data"],"创建失败",{confirmButtonText:"确定"})})))}))},update:function(){var e=this;this.$refs["job_form"].validate((function(t){t&&("interval"===e.request_body.trigger&&("days"===e.interval_type?(e.request_body.day=e.interval_value,e.request_body.hour=null,e.request_body.minute=null,e.request_body.second=null):"hours"===e.interval_type?(e.request_body.hour=e.interval_value,e.request_body.day=null,e.request_body.minute=null,e.request_body.second=null):"minutes"===e.interval_type?(e.request_body.minute=e.interval_value,e.request_body.hour=null,e.request_body.day=null,e.request_body.second=null):"seconds"===e.interval_type&&(e.request_body.second=e.interval_value,e.request_body.hour=null,e.request_body.minute=null,e.request_body.day=null)),"cron"===e.request_body.trigger&&(e.request_body.start_date=null),Object(n["f"])(e.request_body).then((function(t){var r=t.success;console.log(r),!0===r?(e.$router.push("/job/list"),e.$notify({title:"成功",message:"更细规则成功",type:"success"})):e.$alert(e.message["data"],"更新失败",{confirmButtonText:"确定"})})))}))},clearRule:function(){this.queryRuleList(),this.request_body.rule_code=null,this.request_body.rule_name=null},backHistory:function(){this.$router.go(-1)}}},d=s,i=(r("1d01"),r("2877")),c=Object(i["a"])(d,o,u,!1,null,"70c30bd3",null);t["default"]=c.exports},"76fe":function(e,t,r){"use strict";r.d(t,"e",(function(){return u})),r.d(t,"a",(function(){return l})),r.d(t,"f",(function(){return n})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return s})),r.d(t,"b",(function(){return d}));var o=r("b775");function u(e){return Object(o["a"])({url:"/job/queryJob",method:"get",params:e})}function l(e){return Object(o["a"])({url:"/job/addJob",method:"post",data:e})}function n(e){return Object(o["a"])({url:"/job/updateJobInfo/"+e.job_id,method:"post",data:e})}function a(e){return Object(o["a"])({url:"/job/delJob",method:"get",params:e})}function s(e){return Object(o["a"])({url:"/job/info/"+e,method:"get"})}function d(e){return Object(o["a"])({url:"/job/changeStatus",method:"post",data:e})}},8463:function(e,t,r){}}]);